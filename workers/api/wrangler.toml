name = "earningsjr-api"
main = "src/index.ts"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]

# Custom domain route for API
routes = [{ pattern = "api.earningsjr.com/*", zone_name = "earningsjr.com" }]

[observability]
enabled = true

# Bindings (dev will use local durable emulation)
[[d1_databases]]
binding = "DB"
database_name = "earningsjr_db"
database_id = "a2a234d8-ee9a-4e07-a7a1-4e9da8e57a21"

[[kv_namespaces]]
binding = "SESSION_KV"
id = "e740282ef5744352bf5964730389aa6b"

[[r2_buckets]]
binding = "ASSETS"
bucket_name = "earningsjr-assets"

[triggers]
crons = ["0 8 * * 1", "*/15 * * * *"]  # Weekly allowance Monday 08:00 UTC + reminders every 15m

